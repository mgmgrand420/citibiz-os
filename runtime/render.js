import { runActions } from './asx.js';
export const UI={mount(el,tree){el.innerHTML='';el.appendChild(this.render(tree));},render(n){if(!n)return document.createTextNode('');const t=n.type;if(t==='ui.screen'){const w=document.createElement('div');w.className='center';if(n.title){const h=document.createElement('h2');h.textContent=n.title;w.appendChild(h);}const body=this.render({type:n.layout?.type||'vstack',gap:n.layout?.gap||10,align:n.layout?.align||'stretch',children:n.components||[]});w.appendChild(body);return w;} if(t==='vstack'||t==='hstack'){const d=document.createElement('div');d.style.display='flex';d.style.flexDirection=(t==='vstack'?'column':'row');d.style.gap=(n.gap||10)+'px';for(const c of(n.children||[])) d.appendChild(this.render(c));return d;} if(t==='text'){const d=document.createElement('div');d.textContent=String(n.value||'');return d;} if(t==='input'){const i=document.createElement('input');i.className='input';i.placeholder=n.placeholder||'';i.dataset.id=n.id||'';return i;} if(t==='password'){const i=document.createElement('input');i.className='input';i.type='password';i.placeholder=n.placeholder||'';i.dataset.id=n.id||'';return i;} if(t==='file'){const i=document.createElement('input');i.type='file';i.dataset.id=n.id||''; if(n.accept)i.setAttribute('accept',n.accept);return i;} if(t==='button'){const b=document.createElement('button');b.className='btn';b.textContent=n.text||'Button';if(n.action){b.addEventListener('click',async()=>{const map={};document.querySelectorAll('input').forEach(i=>{if(i.dataset.id) map[i.dataset.id]= i.type==='file'? i.files[0]:i.value;});await runActions(n.action,map);});}return b;} if(t==='card'){const d=document.createElement('div');d.className='card';for(const c of(n.children||[])) d.appendChild(this.render(c));return d;} if(t==='sep'){return document.createElement('hr');} if(t==='progress'){const w=document.createElement('div');w.className='card';w.textContent=`Boot ${n.value||0}%`;return w;} return document.createTextNode('[unknown '+t+']');}};